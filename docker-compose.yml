version: '2'

volumes:
  goroot: {}

services:
  test:
    build: .
    command: go test -cover ./...
    volumes:
      - goroot:/go
      - .:/go/src/github.com/pagarme/teleport/

  source:
    build: .
    command: go run main.go -config source_config.yml
    volumes:
      - goroot:/go
      - .:/go/src/github.com/pagarme/teleport/
    ports:
      - 3000:3000

  target:
    build: .
    command: go run main.go -config target_config.yml
    volumes:
      - goroot:/go
      - .:/go/src/github.com/pagarme/teleport/
    ports:
      - 3001:3001

  # Databases
  postgres:
    image: postgres:9.4
    volumes:
        - .:/code
